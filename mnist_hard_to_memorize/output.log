Namespace(arch='res20s', batch_size=128, checkpoint=None, core_set_method='hard_to_memorize', data='data/mnist', data_prune='zero_out', data_rate=0.2, dataset='mnist', decreasing_lr='91,136', eb_eps=0.08, epochs=182, gpu=0, lr=0.1, momentum=0.9, print_freq=50, prune_type='rewind_lt', pruning_times=16, queue_length=5, rate=0.2, resume=False, rewind_epoch=2, save_dir='mnist_hard_to_memorize', seed=None, split_file='npy_files/mnist-train-val.npy', threshold=0, warmup=0, weight_decay=0.0001)
return train dataset:  60000
build model: resnet20
Train number for dataset: 50000
######################################## Start Standard Training Iterative Pruning ########################################
******************************************
pruning state 0
* remain parameters = 267408
******************************************
* remain weight =  100.0 %
0.1
* training images number = 50000
Epoch: [0][0/391]	Loss 3.3997 (3.3997)	Accuracy 10.156 (10.156)	Time 0.12
Epoch: [0][50/391]	Loss 0.6190 (1.2302)	Accuracy 75.781 (57.721)	Time 3.14
Epoch: [0][100/391]	Loss 0.3012 (0.8266)	Accuracy 92.188 (71.674)	Time 2.73
Epoch: [0][150/391]	Loss 0.1642 (0.6410)	Accuracy 95.312 (78.327)	Time 2.83
Epoch: [0][200/391]	Loss 0.2323 (0.5246)	Accuracy 93.750 (82.315)	Time 2.77
Epoch: [0][250/391]	Loss 0.1191 (0.4556)	Accuracy 96.094 (84.770)	Time 2.55
Epoch: [0][300/391]	Loss 0.0533 (0.4061)	Accuracy 99.219 (86.509)	Time 2.49
Epoch: [0][350/391]	Loss 0.0800 (0.3686)	Accuracy 97.656 (87.758)	Time 2.55
train_accuracy 88.552
Test: [0/79]	Loss 0.3123 (0.3123)	Accuracy 89.844 (89.844)
Test: [50/79]	Loss 0.4361 (0.4084)	Accuracy 89.844 (88.634)
valid_accuracy 89.740
Test: [0/79]	Loss 0.2690 (0.2690)	Accuracy 91.406 (91.406)
Test: [50/79]	Loss 0.1913 (0.4724)	Accuracy 93.750 (86.428)
valid_accuracy 88.220
Epoch #0: Train Accuracy: 88.552, Validation Accuracy: 89.74, Test Accuracy: 88.22
Apply Unstructured L1 Pruning
Remove Pruning
0.1
Epoch: [1][0/391]	Loss 0.1267 (0.1267)	Accuracy 96.875 (96.875)	Time 0.06
Epoch: [1][50/391]	Loss 0.1159 (0.1277)	Accuracy 96.094 (96.063)	Time 2.56
Epoch: [1][100/391]	Loss 0.0681 (0.1212)	Accuracy 98.438 (96.326)	Time 2.47
Epoch: [1][150/391]	Loss 0.0463 (0.1126)	Accuracy 98.438 (96.508)	Time 2.72
Epoch: [1][200/391]	Loss 0.0747 (0.1058)	Accuracy 96.875 (96.720)	Time 2.47
Epoch: [1][250/391]	Loss 0.1431 (0.1061)	Accuracy 96.094 (96.738)	Time 2.43
Epoch: [1][300/391]	Loss 0.0592 (0.1021)	Accuracy 96.875 (96.831)	Time 2.52
Epoch: [1][350/391]	Loss 0.0358 (0.1006)	Accuracy 100.000 (96.871)	Time 2.55
train_accuracy 96.918
Test: [0/79]	Loss 0.1305 (0.1305)	Accuracy 93.750 (93.750)
Test: [50/79]	Loss 0.1506 (0.1361)	Accuracy 95.312 (95.787)
valid_accuracy 95.970
Test: [0/79]	Loss 0.0557 (0.0557)	Accuracy 97.656 (97.656)
Test: [50/79]	Loss 0.0096 (0.1866)	Accuracy 100.000 (94.164)
valid_accuracy 95.000
Epoch #1: Train Accuracy: 96.918, Validation Accuracy: 95.97, Test Accuracy: 95.0
Apply Unstructured L1 Pruning
Remove Pruning
* current-mask-distance is = 0.08337821066379547
0.1
Epoch: [2][0/391]	Loss 0.1144 (0.1144)	Accuracy 95.312 (95.312)	Time 0.06
Epoch: [2][50/391]	Loss 0.1549 (0.0881)	Accuracy 95.312 (97.151)	Time 2.44
Epoch: [2][100/391]	Loss 0.0495 (0.0850)	Accuracy 97.656 (97.293)	Time 2.56
Epoch: [2][150/391]	Loss 0.1134 (0.0802)	Accuracy 95.312 (97.413)	Time 2.47
Epoch: [2][200/391]	Loss 0.0206 (0.0807)	Accuracy 100.000 (97.407)	Time 2.45
Epoch: [2][250/391]	Loss 0.0327 (0.0775)	Accuracy 99.219 (97.541)	Time 2.41
Epoch: [2][300/391]	Loss 0.0529 (0.0766)	Accuracy 96.875 (97.537)	Time 2.73
Epoch: [2][350/391]	Loss 0.0609 (0.0762)	Accuracy 98.438 (97.578)	Time 2.66
train_accuracy 97.592
Test: [0/79]	Loss 0.0328 (0.0328)	Accuracy 98.438 (98.438)
Test: [50/79]	Loss 0.0669 (0.0656)	Accuracy 98.438 (97.932)
valid_accuracy 98.040
Test: [0/79]	Loss 0.0908 (0.0908)	Accuracy 98.438 (98.438)
Test: [50/79]	Loss 0.0264 (0.0739)	Accuracy 99.219 (97.656)
valid_accuracy 98.000
Epoch #2: Train Accuracy: 97.592, Validation Accuracy: 98.04, Test Accuracy: 98.0
Apply Unstructured L1 Pruning
Remove Pruning
* current-mask-distance is = 0.07048405706882477
0.1
Epoch: [3][0/391]	Loss 0.0984 (0.0984)	Accuracy 98.438 (98.438)	Time 0.05
Epoch: [3][50/391]	Loss 0.0907 (0.0632)	Accuracy 98.438 (97.932)	Time 2.50
Epoch: [3][100/391]	Loss 0.0467 (0.0654)	Accuracy 98.438 (97.865)	Time 2.57
Epoch: [3][150/391]	Loss 0.0824 (0.0631)	Accuracy 96.094 (97.936)	Time 2.51
Epoch: [3][200/391]	Loss 0.0856 (0.0625)	Accuracy 97.656 (97.959)	Time 2.62
Epoch: [3][250/391]	Loss 0.1523 (0.0680)	Accuracy 96.094 (97.821)	Time 2.43
Epoch: [3][300/391]	Loss 0.0992 (0.0671)	Accuracy 96.875 (97.851)	Time 2.42
Epoch: [3][350/391]	Loss 0.0542 (0.0660)	Accuracy 99.219 (97.863)	Time 2.54
train_accuracy 97.874
Test: [0/79]	Loss 0.0290 (0.0290)	Accuracy 98.438 (98.438)
Test: [50/79]	Loss 0.0481 (0.0532)	Accuracy 98.438 (98.438)
valid_accuracy 98.610
Test: [0/79]	Loss 0.0319 (0.0319)	Accuracy 99.219 (99.219)
Test: [50/79]	Loss 0.0023 (0.0587)	Accuracy 100.000 (98.055)
valid_accuracy 98.430
Epoch #3: Train Accuracy: 97.874, Validation Accuracy: 98.61, Test Accuracy: 98.43
Apply Unstructured L1 Pruning
Remove Pruning
* current-mask-distance is = 0.06379016488790512
0.1
Epoch: [4][0/391]	Loss 0.0276 (0.0276)	Accuracy 99.219 (99.219)	Time 0.05
Epoch: [4][50/391]	Loss 0.0452 (0.0553)	Accuracy 98.438 (98.284)	Time 2.70
Epoch: [4][100/391]	Loss 0.0488 (0.0599)	Accuracy 98.438 (98.167)	Time 2.53
Epoch: [4][150/391]	Loss 0.0504 (0.0610)	Accuracy 97.656 (98.081)	Time 2.42
Epoch: [4][200/391]	Loss 0.1168 (0.0612)	Accuracy 96.094 (98.045)	Time 2.43
Epoch: [4][250/391]	Loss 0.0390 (0.0614)	Accuracy 98.438 (98.048)	Time 2.44
Epoch: [4][300/391]	Loss 0.0284 (0.0616)	Accuracy 99.219 (98.030)	Time 2.44
Epoch: [4][350/391]	Loss 0.0620 (0.0608)	Accuracy 99.219 (98.097)	Time 2.36
train_accuracy 98.106
Test: [0/79]	Loss 0.0104 (0.0104)	Accuracy 100.000 (100.000)
Test: [50/79]	Loss 0.0382 (0.0443)	Accuracy 98.438 (98.438)
valid_accuracy 98.690
Test: [0/79]	Loss 0.0425 (0.0425)	Accuracy 98.438 (98.438)
Test: [50/79]	Loss 0.0038 (0.0523)	Accuracy 100.000 (98.300)
valid_accuracy 98.670
Epoch #4: Train Accuracy: 98.106, Validation Accuracy: 98.69, Test Accuracy: 98.67
Apply Unstructured L1 Pruning
Remove Pruning
* current-mask-distance is = 0.06044695898890495
0.1
Epoch: [5][0/391]	Loss 0.0537 (0.0537)	Accuracy 98.438 (98.438)	Time 0.06
Epoch: [5][50/391]	Loss 0.0110 (0.0465)	Accuracy 100.000 (98.575)	Time 2.46
Epoch: [5][100/391]	Loss 0.0429 (0.0502)	Accuracy 97.656 (98.376)	Time 2.46
Epoch: [5][150/391]	Loss 0.1015 (0.0512)	Accuracy 96.875 (98.350)	Time 2.47
Epoch: [5][200/391]	Loss 0.0485 (0.0498)	Accuracy 97.656 (98.360)	Time 2.45
Epoch: [5][250/391]	Loss 0.0953 (0.0511)	Accuracy 97.656 (98.310)	Time 2.46
Epoch: [5][300/391]	Loss 0.0359 (0.0526)	Accuracy 99.219 (98.290)	Time 2.28
Epoch: [5][350/391]	Loss 0.0134 (0.0544)	Accuracy 100.000 (98.233)	Time 2.33
train_accuracy 98.254
Test: [0/79]	Loss 0.0111 (0.0111)	Accuracy 100.000 (100.000)
Test: [50/79]	Loss 0.0669 (0.0495)	Accuracy 97.656 (98.407)
valid_accuracy 98.540
Test: [0/79]	Loss 0.0566 (0.0566)	Accuracy 98.438 (98.438)
Test: [50/79]	Loss 0.0175 (0.0564)	Accuracy 99.219 (98.116)
valid_accuracy 98.600
Epoch #5: Train Accuracy: 98.254, Validation Accuracy: 98.54, Test Accuracy: 98.6
Apply Unstructured L1 Pruning
Remove Pruning
* current-mask-distance is = 0.062092382460832596
0.1
Epoch: [6][0/391]	Loss 0.0707 (0.0707)	Accuracy 99.219 (99.219)	Time 0.05
Epoch: [6][50/391]	Loss 0.0476 (0.0493)	Accuracy 99.219 (98.361)	Time 2.35
Epoch: [6][100/391]	Loss 0.0525 (0.0535)	Accuracy 99.219 (98.306)	Time 2.37
Epoch: [6][150/391]	Loss 0.0432 (0.0522)	Accuracy 98.438 (98.355)	Time 2.34
Epoch: [6][200/391]	Loss 0.0645 (0.0505)	Accuracy 98.438 (98.445)	Time 2.33
Epoch: [6][250/391]	Loss 0.0486 (0.0492)	Accuracy 98.438 (98.469)	Time 2.35
Epoch: [6][300/391]	Loss 0.0423 (0.0476)	Accuracy 98.438 (98.510)	Time 2.38
Epoch: [6][350/391]	Loss 0.0494 (0.0479)	Accuracy 97.656 (98.489)	Time 2.30
train_accuracy 98.500
Test: [0/79]	Loss 0.0375 (0.0375)	Accuracy 98.438 (98.438)
Test: [50/79]	Loss 0.0735 (0.0541)	Accuracy 96.875 (98.055)
valid_accuracy 98.360
Test: [0/79]	Loss 0.0441 (0.0441)	Accuracy 98.438 (98.438)
Test: [50/79]	Loss 0.0032 (0.0688)	Accuracy 100.000 (97.718)
valid_accuracy 98.190
Epoch #6: Train Accuracy: 98.5, Validation Accuracy: 98.36, Test Accuracy: 98.19
Apply Unstructured L1 Pruning
Remove Pruning
* current-mask-distance is = 0.05957189202308655
* remain weight =  100.0 %
* best SA=98.67
* find early bird tickets at epoch 7
Pruning with custom mask
* remain weight =  79.99985041584395 %
* record size = (60000, 7)
zero all unforgettable images out, rest number =  2697
******************************************
pruning state 1
* remain parameters = 213926.0
******************************************
* remain weight =  79.99985041584395 %
0.1
* training images number = 2697
Epoch: [0][0/22]	Loss 0.7852 (0.7852)	Accuracy 75.781 (75.781)	Time 0.05
train_accuracy 73.712
Test: [0/79]	Loss 0.6654 (0.6654)	Accuracy 79.688 (79.688)
Test: [50/79]	Loss 0.6357 (0.6288)	Accuracy 84.375 (82.353)
valid_accuracy 82.620
Test: [0/79]	Loss 0.5267 (0.5267)	Accuracy 85.156 (85.156)
Test: [50/79]	Loss 0.6175 (0.7800)	Accuracy 85.938 (80.224)
valid_accuracy 80.800
Epoch #0: Train Accuracy: 73.71153130847789, Validation Accuracy: 82.62, Test Accuracy: 80.8
Apply Unstructured L1 Pruning
Remove Pruning
Pruning with custom mask
0.1
Epoch: [1][0/22]	Loss 0.9393 (0.9393)	Accuracy 62.500 (62.500)	Time 0.06
train_accuracy 69.855
Test: [0/79]	Loss 0.1851 (0.1851)	Accuracy 96.094 (96.094)
Test: [50/79]	Loss 0.2725 (0.2852)	Accuracy 89.062 (90.119)
valid_accuracy 90.640
Test: [0/79]	Loss 0.2394 (0.2394)	Accuracy 92.969 (92.969)
Test: [50/79]	Loss 0.1975 (0.3302)	Accuracy 93.750 (88.419)
valid_accuracy 89.570
Epoch #1: Train Accuracy: 69.85539487471702, Validation Accuracy: 90.64, Test Accuracy: 89.57
Apply Unstructured L1 Pruning
Remove Pruning
Pruning with custom mask
* current-mask-distance is = 0.0515318363904953
0.1
Epoch: [2][0/22]	Loss 0.9076 (0.9076)	Accuracy 66.406 (66.406)	Time 0.05
train_accuracy 69.410
Test: [0/79]	Loss 0.1119 (0.1119)	Accuracy 97.656 (97.656)
Test: [50/79]	Loss 0.1562 (0.1068)	Accuracy 94.531 (97.074)
valid_accuracy 97.480
Test: [0/79]	Loss 0.1100 (0.1100)	Accuracy 97.656 (97.656)
Test: [50/79]	Loss 0.0230 (0.1194)	Accuracy 99.219 (96.630)
valid_accuracy 97.180
Epoch #2: Train Accuracy: 69.41045605663375, Validation Accuracy: 97.48, Test Accuracy: 97.18
Apply Unstructured L1 Pruning
Remove Pruning
Pruning with custom mask
* current-mask-distance is = 0.05016687884926796
0.1
Epoch: [3][0/22]	Loss 0.5806 (0.5806)	Accuracy 75.000 (75.000)	Time 0.06
train_accuracy 70.745
Test: [0/79]	Loss 0.0915 (0.0915)	Accuracy 96.875 (96.875)
Test: [50/79]	Loss 0.0950 (0.0983)	Accuracy 96.875 (97.273)
valid_accuracy 97.500
Test: [0/79]	Loss 0.0737 (0.0737)	Accuracy 96.875 (96.875)
Test: [50/79]	Loss 0.0712 (0.1072)	Accuracy 97.656 (96.875)
valid_accuracy 97.230
Epoch #3: Train Accuracy: 70.74527250239704, Validation Accuracy: 97.5, Test Accuracy: 97.23
Apply Unstructured L1 Pruning
Remove Pruning
Pruning with custom mask
* current-mask-distance is = 0.0510176420211792
0.010000000000000002
Epoch: [4][0/22]	Loss 0.5124 (0.5124)	Accuracy 81.250 (81.250)	Time 0.05
train_accuracy 77.271
Test: [0/79]	Loss 0.0556 (0.0556)	Accuracy 98.438 (98.438)
Test: [50/79]	Loss 0.0723 (0.0572)	Accuracy 98.438 (98.683)
valid_accuracy 98.760
Test: [0/79]	Loss 0.0590 (0.0590)	Accuracy 97.656 (97.656)
Test: [50/79]	Loss 0.0143 (0.0685)	Accuracy 100.000 (98.116)
valid_accuracy 98.610
Epoch #4: Train Accuracy: 77.27104189133352, Validation Accuracy: 98.76, Test Accuracy: 98.61
Apply Unstructured L1 Pruning
Remove Pruning
Pruning with custom mask
* current-mask-distance is = 0.008189748041331768
0.010000000000000002
Epoch: [5][0/22]	Loss 0.4973 (0.4973)	Accuracy 84.375 (84.375)	Time 0.13
train_accuracy 81.869
Test: [0/79]	Loss 0.0416 (0.0416)	Accuracy 99.219 (99.219)
Test: [50/79]	Loss 0.0700 (0.0499)	Accuracy 96.875 (98.790)
valid_accuracy 98.920
Test: [0/79]	Loss 0.0388 (0.0388)	Accuracy 99.219 (99.219)
Test: [50/79]	Loss 0.0106 (0.0554)	Accuracy 100.000 (98.438)
valid_accuracy 98.800
Epoch #5: Train Accuracy: 81.8687430393444, Validation Accuracy: 98.92, Test Accuracy: 98.8
Apply Unstructured L1 Pruning
Remove Pruning
Pruning with custom mask
* current-mask-distance is = 0.005833792965859175
0.010000000000000002
Epoch: [6][0/22]	Loss 0.6005 (0.6005)	Accuracy 80.469 (80.469)	Time 0.06
train_accuracy 83.389
Test: [0/79]	Loss 0.0447 (0.0447)	Accuracy 99.219 (99.219)
Test: [50/79]	Loss 0.0650 (0.0481)	Accuracy 98.438 (98.928)
valid_accuracy 98.990
Test: [0/79]	Loss 0.0497 (0.0497)	Accuracy 98.438 (98.438)
Test: [50/79]	Loss 0.0111 (0.0546)	Accuracy 100.000 (98.637)
valid_accuracy 98.960
Epoch #6: Train Accuracy: 83.38895067746081, Validation Accuracy: 98.99, Test Accuracy: 98.96
Apply Unstructured L1 Pruning
Remove Pruning
Pruning with custom mask
* current-mask-distance is = 0.004954984411597252
0.0010000000000000002
Epoch: [7][0/22]	Loss 0.3857 (0.3857)	Accuracy 86.719 (86.719)	Time 0.06
train_accuracy 83.982
Test: [0/79]	Loss 0.0460 (0.0460)	Accuracy 99.219 (99.219)
Test: [50/79]	Loss 0.0662 (0.0478)	Accuracy 98.438 (98.897)
valid_accuracy 99.010
Test: [0/79]	Loss 0.0537 (0.0537)	Accuracy 98.438 (98.438)
Test: [50/79]	Loss 0.0109 (0.0557)	Accuracy 100.000 (98.545)
valid_accuracy 98.870
Epoch #7: Train Accuracy: 83.9822024400914, Validation Accuracy: 99.01, Test Accuracy: 98.87
Apply Unstructured L1 Pruning
Remove Pruning
Pruning with custom mask
* current-mask-distance is = 0.0006076867575757205
0.0010000000000000002
Epoch: [8][0/22]	Loss 0.4539 (0.4539)	Accuracy 85.156 (85.156)	Time 0.05
train_accuracy 83.760
Test: [0/79]	Loss 0.0420 (0.0420)	Accuracy 99.219 (99.219)
Test: [50/79]	Loss 0.0635 (0.0461)	Accuracy 98.438 (98.989)
valid_accuracy 99.080
Test: [0/79]	Loss 0.0521 (0.0521)	Accuracy 98.438 (98.438)
Test: [50/79]	Loss 0.0093 (0.0525)	Accuracy 100.000 (98.652)
valid_accuracy 99.000
Epoch #8: Train Accuracy: 83.75973301407669, Validation Accuracy: 99.08, Test Accuracy: 99.0
Apply Unstructured L1 Pruning
Remove Pruning
Pruning with custom mask
* current-mask-distance is = 0.0007572711911052465
* remain weight =  63.999955124753185 %
* best SA=99.0
* find early bird tickets at epoch 9
Remove Pruning
Pruning with custom mask
* remain weight =  63.999955124753185 %
* record size = (60000, 9)
zero all unforgettable images out, rest number =  1645
Setting up mnist dataset
build model: resnet20
Test: [0/391]	Loss 0.0093 (0.0093)	Accuracy 100.000 (100.000)
Test: [50/391]	Loss 0.0487 (0.0422)	Accuracy 97.656 (98.820)
Test: [100/391]	Loss 0.0324 (0.0430)	Accuracy 98.438 (98.770)
Test: [150/391]	Loss 0.0483 (0.0428)	Accuracy 98.438 (98.769)
Test: [200/391]	Loss 0.0225 (0.0410)	Accuracy 98.438 (98.772)
Test: [250/391]	Loss 0.0357 (0.0405)	Accuracy 98.438 (98.780)
Test: [300/391]	Loss 0.0351 (0.0405)	Accuracy 98.438 (98.785)
Test: [350/391]	Loss 0.0263 (0.0398)	Accuracy 98.438 (98.825)
valid_accuracy 98.790
Pruning with custom mask
* remain weight =  79.99985041584395 %
Test: [0/391]	Loss 0.0390 (0.0390)	Accuracy 98.438 (98.438)
Test: [50/391]	Loss 0.0589 (0.0403)	Accuracy 96.875 (99.050)
Test: [100/391]	Loss 0.0443 (0.0419)	Accuracy 98.438 (99.049)
Test: [150/391]	Loss 0.0216 (0.0420)	Accuracy 99.219 (99.022)
Test: [200/391]	Loss 0.0443 (0.0412)	Accuracy 98.438 (99.079)
Test: [250/391]	Loss 0.0431 (0.0411)	Accuracy 98.438 (99.085)
Test: [300/391]	Loss 0.0690 (0.0416)	Accuracy 97.656 (99.081)
Test: [350/391]	Loss 0.0451 (0.0413)	Accuracy 99.219 (99.096)
valid_accuracy 99.098
* Critical examples for prunings = 0
* Critical examples for training = 1645
* PrAC images = 1645
******************************************
pruning state 2
* remain parameters = 171141.0
******************************************
* remain weight =  63.999955124753185 %
0.1
* training images number = 1645
Epoch: [0][0/13]	Loss 0.9805 (0.9805)	Accuracy 63.281 (63.281)	Time 0.08
train_accuracy 65.410
Test: [0/79]	Loss 0.1388 (0.1388)	Accuracy 95.312 (95.312)
Test: [50/79]	Loss 0.1303 (0.1116)	Accuracy 94.531 (96.569)
valid_accuracy 96.910
Test: [0/79]	Loss 0.1183 (0.1183)	Accuracy 96.875 (96.875)
Test: [50/79]	Loss 0.0280 (0.1267)	Accuracy 100.000 (95.787)
valid_accuracy 96.410
Epoch #0: Train Accuracy: 65.4103342120046, Validation Accuracy: 96.91, Test Accuracy: 96.41
Apply Unstructured L1 Pruning
Remove Pruning
Pruning with custom mask
0.1
Epoch: [1][0/13]	Loss 0.8622 (0.8622)	Accuracy 66.406 (66.406)	Time 0.05
train_accuracy 64.012
Test: [0/79]	Loss 0.1162 (0.1162)	Accuracy 96.094 (96.094)
Test: [50/79]	Loss 0.1611 (0.1548)	Accuracy 96.094 (95.512)
valid_accuracy 95.880
Test: [0/79]	Loss 0.1425 (0.1425)	Accuracy 96.094 (96.094)
Test: [50/79]	Loss 0.0482 (0.1684)	Accuracy 99.219 (94.960)
valid_accuracy 95.600
Epoch #1: Train Accuracy: 64.0121578993406, Validation Accuracy: 95.88, Test Accuracy: 95.6
Apply Unstructured L1 Pruning
Remove Pruning
Pruning with custom mask
* current-mask-distance is = 0.040761709213256836
0.010000000000000002
Epoch: [2][0/13]	Loss 0.9277 (0.9277)	Accuracy 67.188 (67.188)	Time 0.11
train_accuracy 68.875
Test: [0/79]	Loss 0.0655 (0.0655)	Accuracy 98.438 (98.438)
Test: [50/79]	Loss 0.0820 (0.0751)	Accuracy 99.219 (98.177)
valid_accuracy 98.380
Test: [0/79]	Loss 0.0653 (0.0653)	Accuracy 98.438 (98.438)
Test: [50/79]	Loss 0.0223 (0.0845)	Accuracy 100.000 (97.672)
valid_accuracy 98.180
Epoch #2: Train Accuracy: 68.8753797629684, Validation Accuracy: 98.38, Test Accuracy: 98.18
Apply Unstructured L1 Pruning
Remove Pruning
Pruning with custom mask
* current-mask-distance is = 0.00625215470790863
0.010000000000000002
Epoch: [3][0/13]	Loss 0.7232 (0.7232)	Accuracy 72.656 (72.656)	Time 0.05
train_accuracy 73.495
Test: [0/79]	Loss 0.0482 (0.0482)	Accuracy 100.000 (100.000)
Test: [50/79]	Loss 0.0604 (0.0599)	Accuracy 99.219 (98.683)
valid_accuracy 98.790
Test: [0/79]	Loss 0.0551 (0.0551)	Accuracy 98.438 (98.438)
Test: [50/79]	Loss 0.0149 (0.0647)	Accuracy 100.000 (98.483)
valid_accuracy 98.840
Epoch #3: Train Accuracy: 73.49544076658673, Validation Accuracy: 98.79, Test Accuracy: 98.84
Apply Unstructured L1 Pruning
Remove Pruning
Pruning with custom mask
* current-mask-distance is = 0.00532893929630518
0.0010000000000000002
Epoch: [4][0/13]	Loss 0.6339 (0.6339)	Accuracy 73.438 (73.438)	Time 0.06
train_accuracy 74.164
Test: [0/79]	Loss 0.0406 (0.0406)	Accuracy 100.000 (100.000)
Test: [50/79]	Loss 0.0528 (0.0548)	Accuracy 100.000 (98.759)
valid_accuracy 98.880
Test: [0/79]	Loss 0.0516 (0.0516)	Accuracy 98.438 (98.438)
Test: [50/79]	Loss 0.0147 (0.0601)	Accuracy 100.000 (98.591)
valid_accuracy 98.910
Epoch #4: Train Accuracy: 74.164133859188, Validation Accuracy: 98.88, Test Accuracy: 98.91
Apply Unstructured L1 Pruning
Remove Pruning
Pruning with custom mask
* current-mask-distance is = 0.0005141958827152848
* remain weight =  51.200038891880574 %
* best SA=98.91
* find early bird tickets at epoch 5
Remove Pruning
Pruning with custom mask
* remain weight =  51.200038891880574 %
* record size = (60000, 5)
zero all unforgettable images out, rest number =  877
Setting up mnist dataset
build model: resnet20
Test: [0/391]	Loss 0.0093 (0.0093)	Accuracy 100.000 (100.000)
Test: [50/391]	Loss 0.0487 (0.0422)	Accuracy 97.656 (98.820)
Test: [100/391]	Loss 0.0324 (0.0430)	Accuracy 98.438 (98.770)
Test: [150/391]	Loss 0.0483 (0.0428)	Accuracy 98.438 (98.769)
Test: [200/391]	Loss 0.0225 (0.0410)	Accuracy 98.438 (98.772)
Test: [250/391]	Loss 0.0357 (0.0405)	Accuracy 98.438 (98.780)
Test: [300/391]	Loss 0.0351 (0.0405)	Accuracy 98.438 (98.785)
Test: [350/391]	Loss 0.0263 (0.0398)	Accuracy 98.438 (98.825)
valid_accuracy 98.790
Pruning with custom mask
* remain weight =  63.999955124753185 %
Test: [0/391]	Loss 0.0397 (0.0397)	Accuracy 99.219 (99.219)
Test: [50/391]	Loss 0.0623 (0.0470)	Accuracy 96.875 (99.188)
Test: [100/391]	Loss 0.0381 (0.0490)	Accuracy 100.000 (99.064)
Test: [150/391]	Loss 0.0304 (0.0499)	Accuracy 99.219 (99.053)
Test: [200/391]	Loss 0.0532 (0.0499)	Accuracy 98.438 (99.028)
Test: [250/391]	Loss 0.0438 (0.0499)	Accuracy 99.219 (99.057)
Test: [300/391]	Loss 0.0714 (0.0502)	Accuracy 97.656 (99.045)
Test: [350/391]	Loss 0.0522 (0.0501)	Accuracy 98.438 (99.050)
valid_accuracy 99.042
* Critical examples for prunings = 0
* Critical examples for training = 877
* PrAC images = 877
******************************************
pruning state 3
* remain parameters = 136913.0
******************************************
* remain weight =  51.200038891880574 %
0.1
* training images number = 877
Epoch: [0][0/7]	Loss 1.3195 (1.3195)	Accuracy 63.281 (63.281)	Time 0.07
train_accuracy 55.758
Test: [0/79]	Loss 0.3147 (0.3147)	Accuracy 91.406 (91.406)
Test: [50/79]	Loss 0.4379 (0.3052)	Accuracy 83.594 (89.752)
valid_accuracy 90.350
Test: [0/79]	Loss 0.3512 (0.3512)	Accuracy 89.062 (89.062)
Test: [50/79]	Loss 0.2983 (0.3330)	Accuracy 85.156 (88.940)
valid_accuracy 89.490
Epoch #0: Train Accuracy: 55.75826672300646, Validation Accuracy: 90.35, Test Accuracy: 89.49
Apply Unstructured L1 Pruning
Remove Pruning
Pruning with custom mask
0.010000000000000002
Epoch: [1][0/7]	Loss 1.2744 (1.2744)	Accuracy 57.812 (57.812)	Time 0.05
train_accuracy 55.416
Test: [0/79]	Loss 0.1194 (0.1194)	Accuracy 95.312 (95.312)
Test: [50/79]	Loss 0.1555 (0.1092)	Accuracy 96.094 (97.013)
valid_accuracy 97.310
Test: [0/79]	Loss 0.1012 (0.1012)	Accuracy 96.875 (96.875)
Test: [50/79]	Loss 0.0606 (0.1186)	Accuracy 98.438 (96.768)
valid_accuracy 97.290
Epoch #1: Train Accuracy: 55.41619115327076, Validation Accuracy: 97.31, Test Accuracy: 97.29
Apply Unstructured L1 Pruning
Remove Pruning
Pruning with custom mask
* current-mask-distance is = 0.00511273555457592
0.0010000000000000002
Epoch: [2][0/7]	Loss 0.9289 (0.9289)	Accuracy 57.031 (57.031)	Time 0.08
train_accuracy 58.495
Test: [0/79]	Loss 0.0773 (0.0773)	Accuracy 96.875 (96.875)
Test: [50/79]	Loss 0.1082 (0.0764)	Accuracy 96.094 (97.794)
valid_accuracy 98.080
Test: [0/79]	Loss 0.0576 (0.0576)	Accuracy 99.219 (99.219)
Test: [50/79]	Loss 0.0327 (0.0845)	Accuracy 99.219 (97.641)
valid_accuracy 98.050
Epoch #2: Train Accuracy: 58.494868658015776, Validation Accuracy: 98.08, Test Accuracy: 98.05
Apply Unstructured L1 Pruning
Remove Pruning
Pruning with custom mask
* current-mask-distance is = 0.0007303908350877464
* remain weight =  40.95988152934841 %
* best SA=98.05
* find early bird tickets at epoch 3
Remove Pruning
Pruning with custom mask
* remain weight =  40.95988152934841 %
* record size = (60000, 3)
zero all unforgettable images out, rest number =  443
Setting up mnist dataset
build model: resnet20
Test: [0/391]	Loss 0.0093 (0.0093)	Accuracy 100.000 (100.000)
Test: [50/391]	Loss 0.0487 (0.0422)	Accuracy 97.656 (98.820)
Test: [100/391]	Loss 0.0324 (0.0430)	Accuracy 98.438 (98.770)
Test: [150/391]	Loss 0.0483 (0.0428)	Accuracy 98.438 (98.769)
Test: [200/391]	Loss 0.0225 (0.0410)	Accuracy 98.438 (98.772)
Test: [250/391]	Loss 0.0357 (0.0405)	Accuracy 98.438 (98.780)
Test: [300/391]	Loss 0.0351 (0.0405)	Accuracy 98.438 (98.785)
Test: [350/391]	Loss 0.0263 (0.0398)	Accuracy 98.438 (98.825)
valid_accuracy 98.790
Pruning with custom mask
* remain weight =  51.200038891880574 %
Test: [0/391]	Loss 0.0530 (0.0530)	Accuracy 99.219 (99.219)
Test: [50/391]	Loss 0.0644 (0.0657)	Accuracy 98.438 (98.438)
Test: [100/391]	Loss 0.0820 (0.0688)	Accuracy 97.656 (98.252)
Test: [150/391]	Loss 0.0587 (0.0705)	Accuracy 99.219 (98.189)
Test: [200/391]	Loss 0.0648 (0.0709)	Accuracy 98.438 (98.169)
Test: [250/391]	Loss 0.0543 (0.0710)	Accuracy 98.438 (98.157)
Test: [300/391]	Loss 0.0980 (0.0709)	Accuracy 95.312 (98.157)
Test: [350/391]	Loss 0.0745 (0.0707)	Accuracy 98.438 (98.175)
valid_accuracy 98.168
* Critical examples for prunings = 0
* Critical examples for training = 443
* PrAC images = 443
******************************************
pruning state 4
* remain parameters = 109530.0
******************************************
* remain weight =  40.95988152934841 %
0.010000000000000002
* training images number = 443
Epoch: [0][0/4]	Loss 1.7909 (1.7909)	Accuracy 42.969 (42.969)	Time 0.06
train_accuracy 42.664
Test: [0/79]	Loss 0.1686 (0.1686)	Accuracy 93.750 (93.750)
Test: [50/79]	Loss 0.2208 (0.1662)	Accuracy 95.312 (95.374)
valid_accuracy 95.780
Test: [0/79]	Loss 0.1746 (0.1746)	Accuracy 92.188 (92.188)
Test: [50/79]	Loss 0.1081 (0.1761)	Accuracy 97.656 (95.251)
valid_accuracy 95.230
Epoch #0: Train Accuracy: 42.66365708293011, Validation Accuracy: 95.78, Test Accuracy: 95.23
Apply Unstructured L1 Pruning
Remove Pruning
Pruning with custom mask
* remain weight =  32.767905223478735 %
* best SA=95.23
* find early bird tickets at epoch 1
Remove Pruning
Pruning with custom mask
* remain weight =  32.767905223478735 %
* record size = (60000, 1)
zero all unforgettable images out, rest number =  254
Setting up mnist dataset
build model: resnet20
Test: [0/391]	Loss 0.0093 (0.0093)	Accuracy 100.000 (100.000)
Test: [50/391]	Loss 0.0487 (0.0422)	Accuracy 97.656 (98.820)
Test: [100/391]	Loss 0.0324 (0.0430)	Accuracy 98.438 (98.770)
Test: [150/391]	Loss 0.0483 (0.0428)	Accuracy 98.438 (98.769)
Test: [200/391]	Loss 0.0225 (0.0410)	Accuracy 98.438 (98.772)
Test: [250/391]	Loss 0.0357 (0.0405)	Accuracy 98.438 (98.780)
Test: [300/391]	Loss 0.0351 (0.0405)	Accuracy 98.438 (98.785)
Test: [350/391]	Loss 0.0263 (0.0398)	Accuracy 98.438 (98.825)
valid_accuracy 98.790
Pruning with custom mask
* remain weight =  40.95988152934841 %
Test: [0/391]	Loss 0.1172 (0.1172)	Accuracy 98.438 (98.438)
Test: [50/391]	Loss 0.1595 (0.1660)	Accuracy 95.312 (95.374)
Test: [100/391]	Loss 0.2091 (0.1705)	Accuracy 92.969 (95.073)
Test: [150/391]	Loss 0.1767 (0.1734)	Accuracy 95.312 (94.857)
Test: [200/391]	Loss 0.1700 (0.1718)	Accuracy 93.750 (94.900)
Test: [250/391]	Loss 0.1701 (0.1719)	Accuracy 93.750 (94.958)
Test: [300/391]	Loss 0.1717 (0.1723)	Accuracy 95.312 (94.944)
Test: [350/391]	Loss 0.2206 (0.1720)	Accuracy 92.969 (94.945)
valid_accuracy 94.884
* Critical examples for prunings = 0
* Critical examples for training = 254
* PrAC images = 254
******************************************
pruning state 5
* remain parameters = 87624.0
******************************************
* remain weight =  32.767905223478735 %
* remain weight =  32.767905223478735 %
